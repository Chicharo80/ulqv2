<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VISITASULQ</title>
</head>

<body>
<h2>VISITASULQ</h2>

<input id="claveCasa" placeholder="Clave casa"><br>
<input id="motivo" placeholder="Motivo"><br>
<input id="duracion" placeholder="15m / 30m / 1h / 24h"><br>
<input id="nombre" placeholder="Nombre"><br>
<input id="telefono" placeholder="TelÃ©fono"><br><br>

<button onclick="generar()">GENERAR</button>

<pre id="out"></pre>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx3tciNqSXZ0FANw9qnSJSi4zyUOO2OGDexQk1hDdgC7THfl_3f_PfYJ4b3TTKm4ob3/exec";

async function generar(){
  out.textContent = "Generando...";

  try{
    const form = new URLSearchParams();
    form.append("action", "guardar");
    form.append("claveCasa", claveCasa.value);
    form.append("motivo", motivo.value);
    form.append("duracion", duracion.value);
    form.append("nombre", nombre.value);
    form.append("telefono", telefono.value);

    const r = await fetch(API_URL, {
      method: "POST",
      body: form
    });

    const txt = await r.text();
    out.textContent = txt;
  }catch(e){
    out.textContent = "ERROR: " + e.message;
    console.error(e);
  }
}
</script>
</body>
</html>

